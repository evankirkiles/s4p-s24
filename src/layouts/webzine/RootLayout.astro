---
import Footer from "@/components/webzine/Footer.astro";
import Instructions from "@/components/webzine/Instructions.astro";
import Nav from "@/components/webzine/Nav.astro";
import "@/styles/globals.scss";

interface Props {
  disableBlurAndInstructions?: boolean;
}

const { disableBlurAndInstructions } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content={Astro.generator} />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ff0000" />
    <meta name="msapplication-TileColor" content="#b91d47" />
    <meta name="theme-color" content="#ffffff" />
    <slot name="head" />
  </head>
  <body data-blur-disabled={disableBlurAndInstructions || undefined}>
    <Nav />
    <main id="maincontent">
      <slot />
    </main>
    {!disableBlurAndInstructions && <Instructions />}
    <Footer />
  </body>
</html>

<script>
  const maincontent = document.getElementById("maincontent");
  const instructions = document.getElementById("instructions")!;
  // var element = new Image();
  // element.name = "BAD ACTRESS DETECTED. INSTALLING MALWARE...";
  // var devtoolsOpen = false;
  // // @ts-ignore
  // element.__defineGetter__("id", function () {
  //   devtoolsOpen = true; // This only executes when devtools is open.
  // });
  // setInterval(function () {
  //   devtoolsOpen = false;
  //   console.log(element);
  //   if (devtoolsOpen) {
  //     maincontent?.remove();
  //     instructions.innerHTML =
  //       "NO CHEATING<br/>NO CHEATING<br/>NO CHEATING<br/>NO CHEATING<br/>NO CHEATING<br/>";
  //   }
  // }, 250);
</script>

<style lang="scss" is:global>
  :root {
    --color-bg: #ffffff;
    --color-fg: #d60000;
    --color-hl: rgb(39, 32, 103);
  }

  body {
    display: flex;
    flex-direction: column;

    &:not([data-blur-disabled]) > *:not(.Instructions) {
      filter: blur(5px);
    }
  }

  main {
    display: flex;
    flex: 1;
    flex-direction: column;
    margin-inline: auto;
    inline-size: 100%;
    max-inline-size: var(--max-inline-content);
  }
</style>
